import{b as K,_ as X}from"../chunks/Y73nRuH8.js";import"../chunks/DsnmJJEf.js";import{o as ee}from"../chunks/DtuGS-0b.js";import{d as te,aF as re,f as z,a as se,b as S,aG as ae,c as $,s as V,e as A,g as Y,h as k,r as x,n as oe,t as ne}from"../chunks/BZ6-i4bQ.js";import{s as ie}from"../chunks/C9wjyQ8Y.js";import{i as le}from"../chunks/t6rtkQdn.js";import{e as ce,i as ue}from"../chunks/Bhznv5et.js";import{s as fe,c as pe}from"../chunks/CPZ-BBP5.js";import{s as ve,a as de}from"../chunks/BvTaGOGp.js";import{s as me,g as ge}from"../chunks/Cp1gQ7rL.js";var Z={},U={},D=34,R=10,F=13;function H(t){return new Function("d","return {"+t.map(function(a,o){return JSON.stringify(a)+": d["+o+'] || ""'}).join(",")+"}")}function he(t,a){var o=H(t);return function(c,f){return a(o(c),f,t)}}function G(t){var a=Object.create(null),o=[];return t.forEach(function(c){for(var f in c)f in a||o.push(a[f]=f)}),o}function u(t,a){var o=t+"",c=o.length;return c<a?new Array(a-c+1).join(0)+o:o}function be(t){return t<0?"-"+u(-t,6):t>9999?"+"+u(t,6):u(t,4)}function _e(t){var a=t.getUTCHours(),o=t.getUTCMinutes(),c=t.getUTCSeconds(),f=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":be(t.getUTCFullYear())+"-"+u(t.getUTCMonth()+1,2)+"-"+u(t.getUTCDate(),2)+(f?"T"+u(a,2)+":"+u(o,2)+":"+u(c,2)+"."+u(f,3)+"Z":c?"T"+u(a,2)+":"+u(o,2)+":"+u(c,2)+"Z":o||a?"T"+u(a,2)+":"+u(o,2)+"Z":"")}function we(t){var a=new RegExp('["'+t+`
\r]`),o=t.charCodeAt(0);function c(e,n){var m,i,l=f(e,function(h,g){if(m)return m(h,g-1);i=h,m=n?he(h,n):H(h)});return l.columns=i||[],l}function f(e,n){var m=[],i=e.length,l=0,h=0,g,T=i<=0,b=!1;e.charCodeAt(i-1)===R&&--i,e.charCodeAt(i-1)===F&&--i;function r(){if(T)return U;if(b)return b=!1,Z;var p,v=l,d;if(e.charCodeAt(v)===D){for(;l++<i&&e.charCodeAt(l)!==D||e.charCodeAt(++l)===D;);return(p=l)>=i?T=!0:(d=e.charCodeAt(l++))===R?b=!0:d===F&&(b=!0,e.charCodeAt(l)===R&&++l),e.slice(v+1,p-1).replace(/""/g,'"')}for(;l<i;){if((d=e.charCodeAt(p=l++))===R)b=!0;else if(d===F)b=!0,e.charCodeAt(l)===R&&++l;else if(d!==o)continue;return e.slice(v,p)}return T=!0,e.slice(v,i)}for(;(g=r())!==U;){for(var s=[];g!==Z&&g!==U;)s.push(g),g=r();n&&(s=n(s,h++))==null||m.push(s)}return m}function q(e,n){return e.map(function(m){return n.map(function(i){return j(m[i])}).join(t)})}function _(e,n){return n==null&&(n=G(e)),[n.map(j).join(t)].concat(q(e,n)).join(`
`)}function w(e,n){return n==null&&(n=G(e)),q(e,n).join(`
`)}function C(e){return e.map(y).join(`
`)}function y(e){return e.map(j).join(t)}function j(e){return e==null?"":e instanceof Date?_e(e):a.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:c,parseRows:f,format:_,formatBody:w,formatRows:C,formatRow:y,formatValue:j}}var Ce=we(","),ye=Ce.parse;const je=()=>{const t=me;return{page:{subscribe:t.page.subscribe},navigating:{subscribe:t.navigating.subscribe},updated:t.updated}},qe={subscribe(t){return je().page.subscribe(t)}};var Te=z('<li><a class="svelte-q90oap"> </a></li>'),Ee=z('<div class="loading-container svelte-q90oap"><div class="loader svelte-q90oap"></div></div>'),Ae=z('<div class="tabs is-toggle is-centered is-custom mb-2 svelte-q90oap"><ul class="svelte-q90oap"></ul></div> <div class="box svelte-q90oap"><!> <div id="chart" class="svelte-q90oap"></div></div> <div class="notification is-grey-light mb-0 mt-2 svelte-q90oap"><strong class="svelte-q90oap">Position:</strong> Linear projection of activations into 3D subspace*.<br class="svelte-q90oap"/> <strong class="svelte-q90oap">Color:</strong> Activation strength of the studied bilinear form.<br class="svelte-q90oap"/> <strong class="svelte-q90oap">Label:</strong> Shows the current token and the predicted token by the model.<br class="svelte-q90oap"/> <small class="svelte-q90oap">*There may be illusory gaps near the origin due to thresholding of low activations.</small></div>',1);function Ie(t,a){re(a,!0);const o=()=>de(qe,"$page",c),[c,f]=ve();let q;const _=[{name:"Year Circle",url:"/demos/manifolds/year-circle.csv",slug:"year-circle"},{name:"New Triangle",url:"/demos/manifolds/new-triangle.csv",slug:"new-triangle"},{name:"Negation Directions",url:"/demos/manifolds/negation-directions.csv",slug:"negation-directions"},{name:"Conjunction Clusters",url:"/demos/manifolds/conjunction-clusters.csv",slug:"conjunction-clusters"}];let w=Y(0),C=Y(!0),y;async function j(r){A(w,r,!0),A(C,!0),ge(`/demos/manifolds?${_[r].slug}`,{replaceState:!0,noScroll:!0,keepFocus:!0}),await n(_[k(w)].url),A(C,!1)}const e=r=>{const s=+r;return Number.isFinite(s)?s:null};async function n(r){const s=await fetch(r);if(!s.ok)throw new Error(`Failed to fetch ${r}: ${s.status}`);const p=ye(await s.text()),v=[],d=[],N=[],I=[],L=[];for(const E of p){const M=e(E.x),O=e(E.y),P=e(E.z),B=e(E.value);M==null||O==null||P==null||B==null||(v.push(M),d.push(O),N.push(P),I.push(B),L.push(E.token??""))}const J={type:"scatter3d",mode:"markers",x:[0],y:[0],z:[0],hovertemplate:"Origin<extra></extra>",marker:{size:18,color:"#282828"}},Q={type:"scatter3d",mode:"markers",x:v,y:d,z:N,text:L,hovertemplate:"%{text}<extra></extra>",marker:{size:7,color:I,colorscale:[[0,"rgb(222,235,247)"],[.2,"rgb(158,202,225)"],[.4,"rgb(107,174,214)"],[.6,"rgb(66,146,198)"],[.8,"rgb(33,113,181)"],[1,"rgb(8,69,148)"]],reversescale:!1,showscale:!1}},W={margin:{l:0,r:0,t:0,b:0},scene:{xaxis:{visible:!1},yaxis:{visible:!1},zaxis:{visible:!1}},showlegend:!1};await q.newPlot(y,[Q,J],W,{displayModeBar:!1,responsive:!0})}ee(async()=>{q=(await X(async()=>{const{default:s}=await import("../chunks/dDBaQLC6.js").then(p=>p.p);return{default:s}},[],import.meta.url)).default;const r=o().url.search.slice(1);if(r){const s=_.findIndex(p=>p.slug===r);s!==-1&&A(w,s,!0)}await n(_[k(w)].url),A(C,!1)});var m=Ae(),i=se(m),l=$(i);ce(l,21,()=>_,ue,(r,s,p)=>{var v=Te(),d=$(v);d.__click=()=>j(p);var N=$(d,!0);x(d),x(v),ne(()=>{fe(v,1,pe(k(w)===p?"is-active":""),"svelte-q90oap"),ie(N,k(s).name)}),S(r,v)}),x(l),x(i);var h=V(i,2),g=$(h);{var T=r=>{var s=Ee();S(r,s)};le(g,r=>{k(C)&&r(T)})}var b=V(g,2);K(b,r=>y=r,()=>y),x(h),oe(2),S(t,m),ae(),f()}te(["click"]);export{Ie as component};
