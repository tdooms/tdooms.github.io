import{b as Q,_ as W}from"../chunks/pLJzrZlv.js";import"../chunks/DsnmJJEf.js";import{o as G}from"../chunks/fv_zn9Qm.js";import{d as K,am as X,f as L,a as ee,b as N,an as te,c as x,s as I,h as E,g as S,e as B,r as A,n as re,t as ae}from"../chunks/ja8BvbFi.js";import{s as se}from"../chunks/CHcYFDSB.js";import{i as ne}from"../chunks/A3lbEKOY.js";import{e as oe,i as ie}from"../chunks/DxYis3hK.js";import{s as le,c as ce}from"../chunks/CLeBH9m7.js";var V={},U={},D=34,k=10,z=13;function Z(t){return new Function("d","return {"+t.map(function(n,a){return JSON.stringify(n)+": d["+a+'] || ""'}).join(",")+"}")}function ue(t,n){var a=Z(t);return function(l,c){return n(a(l),c,t)}}function Y(t){var n=Object.create(null),a=[];return t.forEach(function(l){for(var c in l)c in n||a.push(n[c]=c)}),a}function f(t,n){var a=t+"",l=a.length;return l<n?new Array(n-l+1).join(0)+a:a}function fe(t){return t<0?"-"+f(-t,6):t>9999?"+"+f(t,6):f(t,4)}function ve(t){var n=t.getUTCHours(),a=t.getUTCMinutes(),l=t.getUTCSeconds(),c=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":fe(t.getUTCFullYear())+"-"+f(t.getUTCMonth()+1,2)+"-"+f(t.getUTCDate(),2)+(c?"T"+f(n,2)+":"+f(a,2)+":"+f(l,2)+"."+f(c,3)+"Z":l?"T"+f(n,2)+":"+f(a,2)+":"+f(l,2)+"Z":a||n?"T"+f(n,2)+":"+f(a,2)+"Z":"")}function me(t){var n=new RegExp('["'+t+`
\r]`),a=t.charCodeAt(0);function l(e,s){var v,o,i=c(e,function(g,r){if(v)return v(g,r-1);o=g,v=s?ue(g,s):Z(g)});return i.columns=o||[],i}function c(e,s){var v=[],o=e.length,i=0,g=0,r,u=o<=0,m=!1;e.charCodeAt(o-1)===k&&--o,e.charCodeAt(o-1)===z&&--o;function p(){if(u)return U;if(m)return m=!1,V;var h,w=i,b;if(e.charCodeAt(w)===D){for(;i++<o&&e.charCodeAt(i)!==D||e.charCodeAt(++i)===D;);return(h=i)>=o?u=!0:(b=e.charCodeAt(i++))===k?m=!0:b===z&&(m=!0,e.charCodeAt(i)===k&&++i),e.slice(w+1,h-1).replace(/""/g,'"')}for(;i<o;){if((b=e.charCodeAt(h=i++))===k)m=!0;else if(b===z)m=!0,e.charCodeAt(i)===k&&++i;else if(b!==a)continue;return e.slice(w,h)}return u=!0,e.slice(w,o)}for(;(r=p())!==U;){for(var d=[];r!==V&&r!==U;)d.push(r),r=p();s&&(d=s(d,g++))==null||v.push(d)}return v}function y(e,s){return e.map(function(v){return s.map(function(o){return _(v[o])}).join(t)})}function q(e,s){return s==null&&(s=Y(e)),[s.map(_).join(t)].concat(y(e,s)).join(`
`)}function R(e,s){return s==null&&(s=Y(e)),y(e,s).join(`
`)}function C(e){return e.map(T).join(`
`)}function T(e){return e.map(_).join(t)}function _(e){return e==null?"":e instanceof Date?ve(e):n.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:l,parseRows:c,format:q,formatBody:R,formatRows:C,formatRow:T,formatValue:_}}var de=me(","),pe=de.parse,he=L('<li><a class="svelte-q90oap"> </a></li>'),ge=L('<div class="loading-container svelte-q90oap"><div class="loader svelte-q90oap"></div></div>'),be=L(`<div class="tabs is-toggle is-centered is-custom mb-2 svelte-q90oap"><ul class="svelte-q90oap"></ul></div> <div class="box svelte-q90oap"><!> <div id="chart" class="svelte-q90oap"></div></div> <div class="notification is-grey-light mb-0 mt-2 svelte-q90oap"><strong class="svelte-q90oap">Position:</strong> Linear projection of activations into 3D subspace*.<br class="svelte-q90oap"/> <strong class="svelte-q90oap">Color:</strong> Activation strength of the studied bilinear form.<br class="svelte-q90oap"/> <strong class="svelte-q90oap">Label:</strong> Shows the current token and the predicted token by the model.<br class="svelte-q90oap"/> <small class="svelte-q90oap">*There may be 'illusory' gaps near the origin due to thresholding of low activations.</small></div>`,1);function Ae(t,n){X(n,!0);let a;const l=[{name:"Year Circle",url:"/demos/manifolds/year-circle.csv"},{name:"New Triangle",url:"/demos/manifolds/new-triangle.csv"},{name:"Negation Directions",url:"/demos/manifolds/negation-directions.csv"},{name:"Conjunction Clusters",url:"/demos/manifolds/conjunction-clusters.csv"}];let c=S(0),y=S(!0),q;async function R(r){B(c,r,!0),await T(l[E(c)].url)}const C=r=>{const u=+r;return Number.isFinite(u)?u:null};async function T(r){const u=await fetch(r);if(!u.ok)throw new Error(`Failed to fetch ${r}: ${u.status}`);const m=pe(await u.text()),p=[],d=[],h=[],w=[],b=[];for(const j of m){const M=C(j.x),O=C(j.y),P=C(j.z),F=C(j.value);M==null||O==null||P==null||F==null||(p.push(M),d.push(O),h.push(P),w.push(F),b.push(j.token??""))}const $={type:"scatter3d",mode:"markers",x:[0],y:[0],z:[0],hovertemplate:"Origin<extra></extra>",marker:{size:18,color:"#282828"}},H={type:"scatter3d",mode:"markers",x:p,y:d,z:h,text:b,hovertemplate:"%{text}<extra></extra>",marker:{size:7,color:w,colorscale:[[0,"rgb(222,235,247)"],[.2,"rgb(158,202,225)"],[.4,"rgb(107,174,214)"],[.6,"rgb(66,146,198)"],[.8,"rgb(33,113,181)"],[1,"rgb(8,69,148)"]],reversescale:!1,showscale:!1}},J={margin:{l:0,r:0,t:0,b:0},scene:{xaxis:{visible:!1},yaxis:{visible:!1},zaxis:{visible:!1}},showlegend:!1};await a.newPlot(q,[H,$],J,{displayModeBar:!1,responsive:!0})}G(async()=>{a=(await W(async()=>{const{default:r}=await import("../chunks/dDBaQLC6.js").then(u=>u.p);return{default:r}},[],import.meta.url)).default,await T(l[E(c)].url),B(y,!1)});var _=be(),e=ee(_),s=x(e);oe(s,21,()=>l,ie,(r,u,m)=>{var p=he(),d=x(p);d.__click=()=>R(m);var h=x(d,!0);A(d),A(p),ae(()=>{le(p,1,ce(E(c)===m?"is-active":""),"svelte-q90oap"),se(h,E(u).name)}),N(r,p)}),A(s),A(e);var v=I(e,2),o=x(v);{var i=r=>{var u=ge();N(r,u)};ne(o,r=>{E(y)&&r(i)})}var g=I(o,2);Q(g,r=>q=r,()=>q),A(v),re(2),N(t,_),te()}K(["click"]);export{Ae as component};
