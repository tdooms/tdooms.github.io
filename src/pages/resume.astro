---
import Layout from '../layouts/Layout.astro';
import Media from '../components/Media.astro';
import { getCollection } from 'astro:content';

const educationEntries = (await getCollection('education')).sort((a, b) => a.data.order - b.data.order);
const workEntries = (await getCollection('work')).sort((a, b) => a.data.order - b.data.order);
const languageEntries = (await getCollection('languages')).sort((a, b) => a.data.order - b.data.order);
const awardEntries = (await getCollection('awards')).sort((a, b) => a.data.order - b.data.order);
---

<Layout>
	<div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
		<!-- Education Column -->
		<div class="lg:col-span-5">
			<h5 class="text-xl font-bold ml-2 mb-4">Education</h5>
			{educationEntries.map(study => <Media {...study.data} />)}
		</div>

		<!-- Work Experience Column -->
		<div class="lg:col-span-7">
			<h5 class="text-xl font-bold ml-2 mb-4">Work Experience</h5>
			{workEntries.map(job => <Media {...job.data} />)}
		</div>
	</div>

	<div class="grid grid-cols-1 lg:grid-cols-12 gap-6 mt-6">
		<!-- Languages Column -->
		<div class="lg:col-span-4">
			<h5 class="text-xl font-bold ml-2 mb-4">Languages</h5>
			
			<div class="card bg-white shadow-md p-6" style="height: 294px;">
				{languageEntries.map(language => (
					<div>
						<div class="flex justify-between items-center py-0">
							<strong>{language.data.name}</strong>
							<span class="text-gray-600">{language.data.level}</span>
						</div>
						<progress 
							class="progress progress-error h-2 mb-4" 
							max="100" 
							value={language.data.percent}
						>
							{language.data.percent}%
						</progress>
					</div>
				))}
			</div>
		</div>

		<!-- Awards Column -->
		<div class="lg:col-span-8">
			<h5 class="text-xl font-bold ml-2 mb-4">Awards</h5>
			
			<div class="card bg-white shadow-md p-6">
				{awardEntries.map(award => (
					<div class="flex items-center gap-3 mb-3">
						<span class="text-2xl text-yellow-500">
							<i class="fa-solid fa-award"></i>
						</span>
						<span>
							{award.data.title}
							<small class="italic text-gray-600 ml-2">
								({award.data.end 
									? `${new Date(award.data.start).getFullYear()} - ${new Date(award.data.end).getFullYear()}` 
									: new Date(award.data.start).getFullYear()})
							</small>
						</span>
					</div>
				))}
			</div>
		</div>
	</div>
</Layout>
